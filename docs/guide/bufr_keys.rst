.. _generic-bufr-keys:

BUFR keys used for the generic and flat readers
++++++++++++++++++++++++++++++++++++++++++++++++

   The following keys are used in the :ref:`generic <generic-reader>` and :ref:`flat <flat-reader>` readers. The keys can be specified in the ``columns``, ``filters`` and ``required_columns`` parameters.

.. _bufr-keys:

BUFR keys
-----------

ecCodes keys from both the BUFR header and data sections are supported in ``columns``, ``filters`` and ``required_columns``. However, there are some limitations:

    * keys containing the rank e.g. "#1#latitude" cannot be used
    * key attributes e.g. "latitude->code" cannot be used

The "count" generated key, which refers to the message index, is also supported but please note that message indexing starts at 1 and not at 0!

.. _computed-bufr-keys:

Computed BUFR keys
-------------------

These keys are not present in the BUFR data but are generated by pdbufr from existing BUFR keys.


.. _key_data_datetime:

data_datetime
+++++++++++++++

    Generated from the "year", "month", "day", "hour", "minute", "second" keys in the BUFR data section. The values are converted to a **datetime.datetime** object.


.. _key_typical_datetime:

typical_datetime
+++++++++++++++++

    Generated from the "typicalYear", "typicalMonth", "typicalDay", "typicalHour", "typicalMinute", "typicalSecond" keys in the BUFR header section. The values are converted to a **datetime.datetime** object.


.. _key_wmo_station_id:

WMO_station_id
++++++++++++++++

    Generated from the "blockNumber" and "stationNumber" keys as::

          blockNumber*1000+stationNumber


.. _key_wigos_station_id:

WIGOS_station_id
++++++++++++++++++

    *New in version 0.12.0*

    Generated from the "wigosIdentifierSeries", "wigosIssuerOfIdentifier",  "wigosIssueNumber" and  "wigosLocalIdentifierCharacter" keys as a str in the following format::

          "{wigosIdentifierSeries}-{wigosIssuerOfIdentifier}-{wigosIssueNumber}-{wigosLocalIdentifierCharacter}


    For example: "0-705-0-1931".

    When using "WIGOS_station_id" in ``filters`` the value can be given as a str or as a tuple/list of 4 values. See: :ref:`filters-section`.

    Details about the WIGOS identifiers can be found `here <https://community.wmo.int/en/activity-areas/WIGOS/implementation-WIGOS/FAQ-WSI>`_.

.. _key_geometry:

geometry
++++++++++

    Values extracted as a list of::

          [longitude,latitude,heightOfStationGroundAboveMeanSeaLevel]

    as required for geopandas.

.. _crs:

CRS
++++

    Generated from the "coordinateReferenceSystem" key using the following mapping:

          .. list-table::
             :header-rows: 1

             * - coordinateReferenceSystem
               - CRS

             * - 0
               - EPSG:4326

             * - 1
               - EPSG:4258

             * - 2
               - EPSG:4269

             * - 3
               - EPSG:4314

             * - 4 or 5
               - not supported

             * - missing
               - EPSG:4326



.. note::

    Computed keys do not preserve their position in ``columns`` but are placed to the end of the resulting DataFrame.
